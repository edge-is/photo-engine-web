function parseJSON(a){try{return JSON.parse(a)}catch(b){return!1}}function controllerArchive(a,b){}function archiveController(a,b){var c=[config.api,"/aggregates/archive"].join("");a.archives=[],b.get(c).success(function(b){a.archives=b.data.results_raw})}function globalsearchController(a,b){a.global_search=function(){a.query&&(b.location="#/?query="+a.query)}}function imageController(a,b,c,d,e,f){var g=b.$$absUrl;e.$on("$locationChangeSuccess",function(a,b){b!==g&&window.location.reload()}),a.imageID=b.search().image,a.cacheKey=b.search().cache,a.image={},c.getByID(a.imageID).success(function(b){a.image=b.data,a.initMap()}),a.center={},a.defaults={scrollWheelZoom:!1},a.mapmarker={},a.initMap=function(b){a.MapLoaded=!1,f.search(a.image._source,function(b){if(0!==b.lenght){var c=b.pop();a.MapLoaded=!0,a.center={lat:+c.lat,lng:+c.lon,zoom:4},a.mapmarker={m1:{lat:+c.lat,lng:+c.lon,message:":)",icon:"img/map-marker.png"}}}})}}function indexController(a,b){a.onTypeaheadSubmit=function(a){b.location="/search.html?query="+a}}function mainSearchController(a,b,c,d,e,f,g){function h(a){var b=parseInt(a);return isNaN(b)?!1:b}if(a.DefaultImage="x-small",a.searchResultsTotal=!1,a.mainSearchHits=[],a.mainSearchSize=0,a.noResults=!1,a.scrollDisabled=!0,a.currentURI=c.$$url,a.showSidebar=!0,a.scrollDisabled=!0,a.photographersapi=[config.api,"/aggregates/Credit"].join(""),setTimeout(function(){a.scrollDisabled=!1},500),a.maxHits=30,a.queryObject={query:a.query,filter:!1,limit:a.maxHits,offset:0},a.onTypeaheadSubmit=function(b){a.queryObject.query=b,a.prevResultsAvailable=!1,a.search(a.queryObject,!0)},a.updateURI=function(b){var d=angular.copy(b);for(var e in d)d[e]||delete d[e],"object"==typeof d[e]&&(d[e]=JSON.stringify(d[e]));c.search(d),a.currentURI=c.$$url},a.search=function(c,d,e){d&&(a.mainSearchHits=[],a.queryObject=c),a.updateURI(c),e=e||function(){},b.query(c).then(function(b){a.displayResultCount=!0,a.searchTime=b.data._took,a.searchResultsTotal=b.data._total,a.submittedQuery=c,0===b.data.hits.length&&(a.noResults=!0),b.data.hits.forEach(function(b){a.mainSearchHits.push(b)}),e()})},a.updateViewPort=function(b){a.submittedQuery.anchor=b,a.updateURI(a.submittedQuery)},a.load_more_data=function(b){if(a.mainSearchHits.length<a.maxHits)return a.noResults=!0;if(!a.scrollDisabled){var c=a.submittedQuery.offset+a.maxHits;if(!(a.searchResultsTotal>c))return a.noResults=!0,a.scrollDisabled=!0;a.submittedQuery.offset=c,a.scrollDisabled=!0,a.search(a.submittedQuery,!1,function(){a.scrollDisabled=!1,setTimeout(b,500)})}},a.openImage=function(b,d,g){var h=e.open({animation:a.animationsEnabled,templateUrl:"views/image-modal.html",controller:"imageModalController",size:"lg",resolve:{data:function(){return{lastURI:a.currentURI,index:b,image:d,results:g}}}});h.result.then(function(b){a.selected=b,c.url(a.currentURI),f.modalOpen=!1},function(){c.url(a.currentURI),f.modalOpen=!1}),f.modalInstance=h},a.queryParams=c.search()||{},a.queryParams.limit=h(a.queryParams.limit)||!1,a.queryParams.offset=h(a.queryParams.offset)||!1,a.queryParams.filter=g.JSON.parse(a.queryParams.filter),a.loadPrevResults=function(){a.queryParams.offset=0,a.prevResultsAvailable=!1,a.search(a.queryParams,!0,function(){var b=a.queryParams.anchor||!1;b&&d(b)})},a.queryParams.query){a.query=a.queryParams.query,a.queryParams.offset>0&&(a.prevResultsAvailable=!0);var i=a.queryParams.anchor||!1;a.search(a.queryParams,!0,function(){i&&d(i)})}a.queryParams.archive&&(a.queryObject.filter={archive_id:a.queryParams.archive}),a.$watchCollection("queryObject.filter",function(b,c){a.search(a.queryObject,!0)})}function directiveBackgroundImage(){return{restrict:"ACE",link:function(a,b,c){var d=["url(",c.backgroundImage,")"].join("");b.css({"background-image":d})}}}function directiveFilterList(a,b,c){return{restrict:"ACE",replace:!0,scope:{queryObject:"=",query:"="},template:function(a,b){var c="'"+b.filterKey+"'";return'<ul class="sidebar-nav"><li class="filterlist-list"  ng-repeat="item in filterResults"><a href ng-click="toggleFilters('+c+', item.value)"><input ng-checked="applydfilters['+c+'] === item.value" type="checkbox"> <span class="list-item-name">{{item.name}}</span> <span class="pull-right">{{item.count}}</span></a></li></ul>'},link:function(d,e,f){function g(a,b,c){return a.map(function(a){var b=a.name;return a.value=b,b.length>c&&(a.name=b.substring(0,c),a.name+=".."),a})}function h(c){console.log("queryObject",c),queryObject=c||{};var e=b.createURI(i,queryObject);"?"!==e&&a.get(e).then(function(a){console.log(queryObject,e),d.filterResults=g(a.data.data[l],j,k)})}var i=f.api,j=f.limit||10,k=f.stringLength||15,l="results_raw";if(d.applydfilters={},"raw"===f.resultType)var l="results_raw";d.toggleFilters=function(a,b){return d.queryObject.filter||(d.queryObject.filter={}),d.applydfilters[a]===b?(delete d.applydfilters[a],delete d.queryObject.filter[a],h(d.queryObject)):(d.applydfilters[a]=b,d.queryObject.filter[a]=b,void h(d.queryObject))},c.$on("queryUpdate",function(a,b,c){h({query:b,filter:d.queryObject.filter})}),h()}}}function directiveInView(a){return{restrict:"A",link:function(b,c,d,e){function f(a){return a%2==0}function g(a){var b=$(window).scrollTop(),c=b+$(window).height(),d=$(a).offset().top,e=d+$(a).height();return c>=e&&d>=b}var h=d.inViewOffset,i=d.inViewCount,j=d.id,k=function(){},l=d.inView,m=b.$parent[l];if("function"==typeof m){k=m;var n=!1;f(i/h)&&angular.element(a).bind("scroll",function(){n||(n=!0,setTimeout(function(){g(c)&&k(j,c),n=!1},1e3))})}}}}function directiveLazyImage(a){return{restrict:"ACE",template:function(a,b){return'<img class="low-resolution-image" ng-src="'+b.lowres+'"></img><img class="hidden high-resolution-image" ng-src="'+b.highres+'"></img>'},link:function(b,c,d){$(".high-resolution-image").bind("load",function(){$(".low-resolution-image").addClass("hidden"),b.$apply(),a(function(){$(".high-resolution-image").removeClass("hidden").unbind("load")},10),$(".low-resolution-image").remove()})}}}function directiveRandomArchiveImage(a,b){return{restrict:"ACE",template:function(a,b){return'<div class="carousel slide archives-carousel random-image-carousel" data-ride="carousel"><div class="carousel-inner" role="listbox"><div class="item active"><img class="archives-random-image" ng-src="{{selectedImage}}"><div class="carousel-caption"><h5>{{archive_name}}</h5></div></div></div></div>'},replace:!0,link:function(c,d,e){c.availableImages=[],c.archive_name=e.archiveName,c.image_name="";var f=[config.api,"/random/archives?archive_id=",e.archive].join("");a.get(f).success(function(a){c.availableImages=a.data.hits;var e=a.data.hits.pop();if(!e){var f=$(d).closest(".random-archive-images-container");return void f.addClass("hidden")}c.image_name=e._id,c.selectedArchiveImage=e._source.cdn1.small,c.selectedImage=c.selectedArchiveImage,b(d)(c)})}}}function directiveTypeaheadSuggest(a){return{restrict:"ACE",replace:!0,require:"?ngModel",template:function(a,b){return'<input type="text" ng-mode="'+b.ngModel+'" class="'+b["class"]+'">'},link:function(b,c,d,e){function f(a,b){return a.score<b.score?-1:a.score>b.score?1:0}function g(a,b){var c=a.join(" ");return b.map(function(a){return[c,a].join(" ")})}function h(a){var b=[];for(var c in a.suggest){var d=a.suggest[c];0!==d.length&&d[0].options.forEach(function(a){b.push(a)})}var e=b.sort(f).reverse(),g=e.map(function(a){return a.text});return g}function i(){return function(b,c,d){var e=b.split(" "),f=e.pop();a(f).then(function(a){var b=h(a.data.data);b=g(e,b),d(b)},function(){d([])})}}function j(a,c,d){k(a,c,d),b.$apply(function(){var a=angular.isDefined(b.suggestionKey)?c[b.suggestionKey]:c;e.$setViewValue(a)})}var k=function(){};"function"==typeof b[d.submit]&&(k=b[d.submit]),console.log(e),$(c).typeahead({hint:!0,highlight:!1,minLength:1,async:!0},{async:!0,name:"suggester",source:i()}),c.bind("typeahead:selected",function(a,c,d){j(a,c,d),b.$emit("typeahead:selected",c,d)}),c.bind("typeahead:autocompleted",function(a,c,d){j(a,c,d),b.$emit("typeahead:autocompleted",c,d)}),c.bind("typeahead:opened",function(){b.$emit("typeahead:opened")}),c.bind("typeahead:closed",function(){b.$emit("typeahead:closed")}),c.bind("typeahead:asyncrequest",function(){b.$emit("typeahead:asyncrequest")}),c.bind("typeahead:asynccancel",function(){b.$emit("typeahead:asynccancel")}),c.bind("typeahead:asyncreceive",function(){b.$emit("typeahead:asyncreceive")}),c.bind("typeahead:cursorchanged",function(a,c,d){b.$emit("typeahead:cursorchanged",a,c,d)})}}}function typeaheadDirective(a,b){return{restrict:"ACE",replace:!0,scope:{query:"=",onTypeaheadSubmit:"="},template:function(a,b){return'<input type="text" ng-model="query" class="form-control" placeholder="{{placeholder}}">'},link:function(c,d,e){function f(a,b,c){l(b)}function g(a,b){var c={};return a.filter(function(a){var d=a[b];return c[d]?!1:(c[d]=!0,!0)})}function h(a){return function(b,c){return b[a]<c[a]?-1:b[a]>c[a]?1:0}}function i(a){var b=[];for(var c in a.suggest){var d=a.suggest[c],e=d.pop().options;e.forEach(function(a){b.push(a)})}var f=b.sort(h("score")).reverse();return g(f,"text")}function j(){return function(b,c,d){a(b).then(function(a){var b=i(a.data.data),c=b.map(function(a){return a.text});d(c)},function(){d([])})}}c.placeholder=e.inputPlaceholder;var k=$(d).closest("form"),l="function"==typeof c.onTypeaheadSubmit?c.onTypeaheadSubmit:function(){};$(k).on("submit",function(a){return a.preventDefault(),l(c.query),!1}),c.$watch("query",function(a,c){b.$emit("queryUpdate",a,c)}),$(d).typeahead({hint:!0,highlight:!1,minLength:1,async:!0},{async:!0,name:"suggester",source:j()}),d.bind("typeahead:selected",function(a,b,d){f(a,b,d),c.$emit("typeahead:selected",b,d)}),d.bind("typeahead:autocompleted",function(a,b,d){f(a,b,d),c.$emit("typeahead:autocompleted",b,d)}),d.bind("typeahead:opened",function(){c.$emit("typeahead:opened")}),d.bind("typeahead:closed",function(){c.$emit("typeahead:closed")}),d.bind("typeahead:asyncrequest",function(){c.$emit("typeahead:asyncrequest")}),d.bind("typeahead:asynccancel",function(){c.$emit("typeahead:asynccancel")}),d.bind("typeahead:asyncreceive",function(){c.$emit("typeahead:asyncreceive")}),d.bind("typeahead:cursorchanged",function(a,b,d){c.$emit("typeahead:cursorchanged",a,b,d)})}}}function cacheFactory(a){return{get:function(b){var c=(new Date).getTime(),d=a.get(b);return d.__ttl&&__cache.ttl<c?!1:d.__value?d.__value:(delete d.__ttl,d)},put:function(b,c){c=c||!1;var d=b;"string"==typeof b&&(d={__value:b});var e=(new Date).getTime(),f=e+c;return d.__ttl=f,a.put(d)}}}function developmentService(a,b,c){return function(){if(config.development){var d="developmentDismiss",e=b.get(d);return e?a.info("DEVELOPMENT: Already dismissed"):void c.set("Þessi vefur er í vinnslu.",{html:!0,sticky:!0,button:!0},function(){b.put(d,"true")})}}}function serviceImage(a){return{getImageByID:function(b){var c=[config.api,"/image/",b].join("");return a.get(c)}}}function serviceOSM(a){return{search:function(b,c){console.log("OSM");var d={},e=!1;"City"in b?(e=!0,d.city=b.City):"State"in b&&(e=!0,d.state=b.State),"Country"in b&&b.Country.split(" ").length<=2&&(d.Country=b.Country),1==e&&a.osm(d).then(c)}}}function photoApiService(a,b,c){function d(b){return a.get(b)}return{getByID:function(a){var b=[config.api,"/image/",a].join("");return d(b)},filter:function(a){},query:function(d,e){var f=b.defer();e=e||{};var g=[config.api,"/search/query"].join("");d.limit=d.limit||30,d.offset=d.offset||30;var h=c.createURI(g,d);return a.get(h).success(function(a){f.resolve(a)}).error(function(a){f.reject(a)}),f.promise}}}function serviceSuggester(a){return function(b,c,d){d=d||{};var e=[config.api,"/search/suggest/phrase?"].join(""),f=d.url||e,g=[f,"filter=",c,"&query=",b].join("");return a.get(g)}}function serviceUtils(){return{JSON:{parse:function(a){try{return JSON.parse(a)}catch(b){return!1}},stringify:function(a){try{return JSON.parse(a)}catch(b){return!1}}},createURI:function(a,b){var c=angular.copy(b),d=[];for(var e in c){var f=c[e];"object"==typeof f&&(f=JSON.stringify(f)),f&&d.push([e,f].join("="))}var g=d.join("&");return[a,g].join("?")},each:function(a,b){!function(a,b){for(var c in a)b(c,a[c])}(a,b)}}}var search=angular.module("search",["siyfion.sfTypeahead","ui.bootstrap","nemLogging","leaflet-directive","cfp.hotkeys","ui.select","ngSanitize","angularScroll","ngNotify","ngCookies"]);search.run(["$rootScope","$location",function(a,b){a.history=[],a.oldPath=b.$$path,a.$on("$locationChangeStart",function(c,d){a.oldPath=b.$$path}),a.$on("$locationChangeSuccess",function(c,d){function e(b){var c=a.history[a.history.length-2];return c&&c.absUrl===b?c:!1}var f=b.$$path,g=e(d);g&&a.$emit("historyBack",g);var h=a.history[a.history.length-1];if(console.log(a.modalOpen,f,h),a.modalOpen){if(!h)return;f!==h.path&&a.modalInstance.close()}a.history.push({url:b.$$url,path:b.$$path,absUrl:b.$$absUrl,params:b.search()})})}]);var settings={search:{fields:{BitsPerSample:{type:"long"},CaptionWriter:{type:"string"},Category:{type:"string"},City:{type:"string"},ColorComponents:{type:"long"},ColorMode:{type:"string"},Comment:{type:"string"},Country:{type:"string"},Credit:{type:"string"},DateCreated:{type:"date"},Description:{type:"string"},Directory:{type:"string"},ExifImageHeight:{type:"long"},ExifImageWidth:{type:"long"},FileName:{type:"string"},FileType:{type:"string"},ImageHeight:{type:"long"},ImageWidth:{type:"long"},Instructions:{type:"string"},Keywords:{type:"string"},LocalCaption:{type:"string"},MIMEType:{type:"string"},ObjectName:{type:"string"},Orientation:{type:"string"},PhotometricInterpretation:{type:"string"},ProfileFileSignature:{type:"string"},ReleaseDate:{type:"date"},Rights:{type:"string"},Source:{type:"string"},SourceFile:{type:"string"},SpecialInstructions:{type:"string"},State:{type:"string"},Subject:{type:"array"},SupplementalCategories:{type:"array"},Title:{type:"string"},XResolution:{type:"long"},YResolution:{type:"long"},safn:{type:"string"}}}};search.config(["$locationProvider","uiSelectConfig",function(a,b){b.theme="bootstrap",a.html5Mode({enabled:!0,requireBase:!1,reloadOnSearch:!0})}]),search.controller("archive",["$scope","$location",controllerArchive]),search.controller("archives",["$scope","$http",archiveController]),search.controller("globalsearch",["$scope","$window",globalsearchController]),search.controller("imageModalController",["$scope","$location","$modalInstance","data","hotkeys","$rootScope","osm",function(a,b,c,d,e,f,g){function h(b){(document.webkitIsFullScreen===!1||document.mozFullScreen===!1||null===document.msFullscreenElement)&&(a.isFullscreen=!1,a.fullscreenClass="no-fullscreen")}setTimeout(function(){f.modalOpen=!0},300),a.index=d.index,a.images=d.results,a.image=d.image,a.isFullscreen=!1,a.fullscreenClass="no-fullscreen",a.lastURI=d.lastURI,a.currentLocation=b.$$url,a.close=function(){c.close()},a.dismiss=function(){c.dismiss()},f.$on("historyBack",function(b,c){console.log("Hey!, back?",b,c,a.index)}),a.nextImg=a.images[a.index+1],a.prevImg=a.images[a.index-1],a.next=function(){a.index+1<a.images.length&&(a.StopLazy(),a.index=a.index+1,a.image=a.images[a.index],a.nextImg=a.images[a.index],a.prevImg=a.images[a.index-1],b.url("image.html?image="+a.image._id))},a.prev=function(){a.index>0&&(a.StopLazy(),a.index=a.index-1,a.image=a.images[a.index],a.prevImg=a.images[a.index],b.url("image.html?image="+a.image._id))},a.nextURL=function(){return a.nextImg?"/image.html?image="+a.nextImg._id:void 0},a.prevURL=function(){return a.prevImg?"/image.html?image="+a.prevImg._id:void 0},a.isNext=function(){var b=a.images.length;return a.index+1>=b?!1:!0},a.isPrev=function(){return 0==a.index?!1:!0},a.landscape=function(a){return a._source.ImageWidth<a._source.ImageHeight?!1:!0},a.StopLazy=function(){$(".high-resolution-image").unbind("load")};var i="webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange";$(document).on(i,h),a.fullscreen=function(){var b=document.getElementById("preview_carousel");b.requestFullscreen?b.requestFullscreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.msRequestFullscreen&&b.msRequestFullscreen(),a.fullscreenClass="fullscreen",a.isFullscreen=!0},e.bindTo(a).add({combo:"right",description:"Select next image.",callback:function(){a.next()}}).add({combo:"left",description:"Select prev image",callback:function(){a.prev()}}),a.center={},a.defaults={scrollWheelZoom:!1},a.mapmarker={},a.Map=function(){a.MapLoaded=!1,g.search(a.image._source,function(b){console.log(b),b.length>0&&(a.MapLoaded=!0,a.center={lat:+b[0].lat,lng:+b[0].lon,zoom:4},a.mapmarker={m1:{lat:+b[0].lat,lng:+b[0].lon,message:"Wazzuuup?",icon:"img/map-marker.png"}})})}}]),search.controller("index",["$scope","$window",indexController]),search.controller("main",["$scope","$window","_search","$uibModal","$log","$location","imageCache","notifyDevelopment",function(a,b,c,d,e,f,g,h){function i(b,d,e){d=d||"query",angular.element("#mainsearch").focus(),a.MainSearchHidden=!1,a.StartSearchHidden=!0,angular.element("body")[0].scrollTop=0,c.query(a.mainSearchQuery,a.mainSearchOptions).then(function(b){a.displayResultCount=!0,a.searchTime=b.data._took,a.searchResultsTotal=b.data._total,a.mainSearchHits=b.data.hits,a.submittedQuery=a.mainSearchQuery,a.mainSearchSize=b.data.hits.length}),a.lastSearchURI=f.$$url}a.photographersapi=[config.api,"/aggregates/Credit"].join(""),a.keywordsApi=[config.api,"/aggregates/Keywords"].join(""),h(),a.filters={},a.MainSearchHidden=!0,a.MainSearch="",a.StartSearch="",a.typeaheadquery="",a.searchTime=0,a.searchResultsTotal=0,a.mainSearchHits=[],a.displayResultCount=!1,a.scrollDisabled=!1,a.mainSearchOptions={limit:30,offset:0};var j=new Bloodhound({datumTokenizer:function(a){return Bloodhound.tokenizers.whitespace(a.num)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:config.api+"/search/typeahead?query={query}*",wildcard:"{query}",filter:function(a){return a.data.hits}}});j.clear(),j.initialize(),a.TypeaheadEngineData={displayKey:"hit",source:j.ttAdapter()},a.TypeaheadOptions={highlight:!0},a.mainSearchQuery=f.search().query||"",a.mainSearchFilter=f.search().filter||"",(""!==a.mainSearchQuery||""!==a.mainSearchFilter)&&(setTimeout(function(){a.MainSearch=a.mainSearchQuery,a.$apply()},100),i(a.mainSearchQuery)),a.$watch("StartSearch",function(b,c){a.StartSearch.length>0&&(angular.element("#mainsearch").focus(),a.MainSearchHidden=!1,setTimeout(function(){a.StartSearchHidden=!0},20)),a.MainSearch=a.StartSearch}),a.submitMainSearch=function(){a.MainSearch.hit?a.mainSearchQuery=a.MainSearch.hit:a.mainSearchQuery=a.MainSearch,a.setURI(),i(a.mainSearchQuery)},a.setURI=function(){var b={};""!==a.mainSearchQuery&&(b.query=a.mainSearchQuery),""!==a.mainSearchFilter&&(b.filter=a.mainSearchFilter),f.search(b)},a.$on("typeahead:selected",function(b,c,d){a.MainSearch.hit?a.mainSearchQuery=a.MainSearch.hit:a.mainSearchQuery=a.MainSearch,a.setURI(),i(a.mainSearchQuery)}),a.landscape=function(a){return a._source.ImageWidth<a._source.ImageHeight?!1:!0};var k=angular.element(b);a.windowWidth=k.width(),a.DefaultImage="x-small",a.load_more_data=function(b){if(!(a.mainSearchSize<1)){var d={limit:a.mainSearchOptions.limit,offset:a.mainSearchSize};c.query(a.submittedQuery,d).then(function(c){c&&(c.data.hits.length<1||(a.searchTime=c.data._took,a.searchResultsTotal=c.data._total,c.data.hits.forEach(function(b){a.mainSearchHits.push(b)}),a.mainSearchSize+=c.data.hits.length,b()))})}},a.openImage=function(a,b,c){g.image=b,g.index=a,g.images=c},a.openAdvancedSearch=function(b,e,g){var h=d.open({templateUrl:"views/advanced-search-modal.html",controller:"AdvancedSearchController",size:"lg",resolve:{data:function(){return{}}}});h.result.then(function(a){var b=c.advancedSearch(a,{});b.success(function(a){console.log(a)})},function(){f.url(a.lastSearchURI)})}}]),search.directive("backgroundImage",[directiveBackgroundImage]),search.directive("filterList",["$http","utils","$rootScope",directiveFilterList]),search.directive("inView",["$window",directiveInView]),search.directive("lazyimg",["$timeout",directiveLazyImage]),search.directive("randomArchiveImage",["$http","$compile",directiveRandomArchiveImage]),search.directive("typeaheadSuggest",["suggester",directiveTypeaheadSuggest]),search.filter("ms",[function(){return function(a){var b=a/1e3;return isNaN(b)?"":b+"s"}}]),search.filter("propsFilter",function(){return function(a,b){var c=[];return angular.isArray(a)?a.forEach(function(a){for(var d=!1,e=Object.keys(b),f=0;f<e.length;f++){var g=e[f],h=b[g].toLowerCase();if(-1!==a[g].toString().toLowerCase().indexOf(h)){d=!0;break}}d&&c.push(a)}):c=a,c}}),search.service("photoApi",["$http","$q","utils",photoApiService]),search.controller("image",["$scope","$location","photoApi","cacheFactory","$rootScope","osm",imageController]),search.controller("mainSearch",["$scope","photoApi","$location","$anchorScroll","$uibModal","$rootScope","utils",mainSearchController]),search.directive("typeaheadSearch",["suggester","$rootScope",typeaheadDirective]),search.factory("cacheFactory",["$cacheFactory",cacheFactory]),search.service("osm",["map",serviceOSM]),search.service("notifyDevelopment",["$log","$cookies","ngNotify",developmentService]),search.service("imageService",["$http",serviceImage]),search.service("suggester",["$http",serviceSuggester]),search.service("utils",serviceUtils),search.service("_search",["$http","$q",function(a,b){function c(b,c){return a.post(b,c)}return{typeahead:function(a){},filter:function(a){},advancedSearch:function(a,d){d||(d={});var e=d.limit||30,f=d.offset||0,g=(b.defer(),[config.api,"/search/advanced?"].join(""));return g+="limit="+e,g+="&offset="+f,c(g,a)},query:function(c,d){d||(d={});var e=d.limit||30,f=d.offset||0,g=b.defer(),h=[config.api,"/search/query?"].join("");return h+="limit="+e,h+="&offset="+f,h+="&query="+c,a.get(h).success(function(a){g.resolve(a)}).error(function(a){g.reject(a)}),g.promise}}}]),search.service("map",["$http","$q",function(a,b){return{osm:function(c){var d=b.defer(),e={url:"https://nominatim.openstreetmap.org/search.php",method:"GET",params:c};return e.params.format="json",a(e).success(function(a){d.resolve(a)}).error(function(a){d.reject(a)}),d.promise}}}]),search.service("translate",[function(){return function(a){if("lang"in window==!1)return{name:a};if(a in lang){var b=lang[a];return""!==b.name?b:{name:a}}return{name:a}}}]);
//# sourceMappingURL=application.min.js.map